// DOM elements
const wishInput = document.getElementById('wishInput');
const charCount = document.getElementById('charCount');
const stars = document.querySelectorAll('.star');
const messageArea = document.getElementById('messageArea');
const wishMessage = document.getElementById('wishMessage');
const remainingCount = document.getElementById('remainingCount');


// LocalStorage key for storing used stars
const STORAGE_KEY = 'wishStarsUsed';

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    loadStarStates();
        updateRemainingCount();
            setupEventListeners();
            });

            // Set up all event listeners
            function setupEventListeners() {
                // Character counter for textarea
                    wishInput.addEventListener('input', updateCharacterCount);
                        
                            // Star click events
                                stars.forEach(star => {
                                        star.addEventListener('click', handleStarClick);
                                            });
                                                

                                                    
                                                        // Hide message when user starts typing
                                                            wishInput.addEventListener('focus', hideMessage);
                                                            }

                                                            // Update character counter
                                                            function updateCharacterCount() {
                                                                const currentLength = wishInput.value.length;
                                                                    charCount.textContent = currentLength;
                                                                        
                                                                            // Change color based on character limit
                                                                                if (currentLength > 450) {
                                                                                        charCount.style.color = '#e53e3e';
                                                                                            } else if (currentLength > 350) {
                                                                                                    charCount.style.color = '#dd6b20';
                                                                                                        } else {
                                                                                                                charCount.style.color = '#718096';
                                                                                                                    }
                                                                                                                    }

                                                                                                                    // Handle star click
                                                                                                                    function handleStarClick(event) {
                                                                                                                        const star = event.currentTarget;
                                                                                                                            const starNumber = star.dataset.starNumber;
                                                                                                                                
                                                                                                                                    // Check if star is already used
                                                                                                                                        if (star.classList.contains('used')) {
                                                                                                                                                showTemporaryMessage('‚≠ê This star has already been used!', 'warning');
                                                                                                                                                        return;
                                                                                                                                                            }
                                                                                                                                                                
                                                                                                                                                                    // Check if wish is entered
                                                                                                                                                                        const wishText = wishInput.value.trim();
                                                                                                                                                                            if (!wishText) {
                                                                                                                                                                                    showTemporaryMessage('‚úçÔ∏è Please enter a wish first!', 'warning');
                                                                                                                                                                                            wishInput.focus();
                                                                                                                                                                                                    return;
                                                                                                                                                                                                        }
                                                                                                                                                                                                            
                                                                                                                                                                                                                // Add clicking animation
                                                                                                                                                                                                                    star.classList.add('clicking');
                                                                                                                                                                                                                        setTimeout(() => star.classList.remove('clicking'), 300);
                                                                                                                                                                                                                            
                                                                                                                                                                                                                                // Mark star as used
                                                                                                                                                                                                                                    markStarAsUsed(starNumber);
                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                            // Generate and copy wish message
                                                                                                                                                                                                                                                const message = `You used wish number ${starNumber}. You wish: "${wishText}"`;
                                                                                                                                                                                                                                                    copyToClipboard(message);
                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                            // Show success message
                                                                                                                                                                                                                                                                showWishMessage(message);
                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                        // Update remaining count
                                                                                                                                                                                                                                                                            updateRemainingCount();
                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                    // Clear the wish input
                                                                                                                                                                                                                                                                                        setTimeout(() => {
                                                                                                                                                                                                                                                                                                wishInput.value = '';
                                                                                                                                                                                                                                                                                                        updateCharacterCount();
                                                                                                                                                                                                                                                                                                            }, 1000);
                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                            // Mark a star as used and save to localStorage
                                                                                                                                                                                                                                                                                                            function markStarAsUsed(starNumber) {
                                                                                                                                                                                                                                                                                                                const star = document.getElementById(`star${starNumber}`);
                                                                                                                                                                                                                                                                                                                    star.classList.add('used');
                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                            // Update localStorage
                                                                                                                                                                                                                                                                                                                                const usedStars = getUsedStars();
                                                                                                                                                                                                                                                                                                                                    usedStars.push(parseInt(starNumber));
                                                                                                                                                                                                                                                                                                                                        localStorage.setItem(STORAGE_KEY, JSON.stringify(usedStars));
                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                        // Get used stars from localStorage
                                                                                                                                                                                                                                                                                                                                        function getUsedStars() {
                                                                                                                                                                                                                                                                                                                                            const stored = localStorage.getItem(STORAGE_KEY);
                                                                                                                                                                                                                                                                                                                                                return stored ? JSON.parse(stored) : [];
                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                // Load star states from localStorage
                                                                                                                                                                                                                                                                                                                                                function loadStarStates() {
                                                                                                                                                                                                                                                                                                                                                    const usedStars = getUsedStars();
                                                                                                                                                                                                                                                                                                                                                        usedStars.forEach(starNumber => {
                                                                                                                                                                                                                                                                                                                                                                const star = document.getElementById(`star${starNumber}`);
                                                                                                                                                                                                                                                                                                                                                                        if (star) {
                                                                                                                                                                                                                                                                                                                                                                                    star.classList.add('used');
                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                // Update remaining wishes count
                                                                                                                                                                                                                                                                                                                                                                                                function updateRemainingCount() {
                                                                                                                                                                                                                                                                                                                                                                                                    const usedStars = getUsedStars();
                                                                                                                                                                                                                                                                                                                                                                                                        const remaining = 3 - usedStars.length;
                                                                                                                                                                                                                                                                                                                                                                                                            remainingCount.textContent = remaining;
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                    // Update message based on remaining wishes
                                                                                                                                                                                                                                                                                                                                                                                                                        const wishesRemaining = document.getElementById('wishesRemaining');
                                                                                                                                                                                                                                                                                                                                                                                                                            if (remaining === 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                    wishesRemaining.innerHTML = 'üåü All wishes have been used! Your magical stars are permanently spent.';
                                                                                                                                                                                                                                                                                                                                                                                                                                            wishesRemaining.style.color = '#e53e3e';
                                                                                                                                                                                                                                                                                                                                                                                                                                                } else if (remaining === 1) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                        wishesRemaining.innerHTML = `You have <span id="remainingCount">${remaining}</span> wish remaining`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                wishesRemaining.style.color = '#dd6b20';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            wishesRemaining.innerHTML = `You have <span id="remainingCount">${remaining}</span> wishes remaining`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    wishesRemaining.style.color = '#4a5568';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Copy text to clipboard
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        async function copyToClipboard(text) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Modern clipboard API
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (navigator.clipboard && window.isSecureContext) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        await navigator.clipboard.writeText(text);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Fallback for older browsers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const textArea = document.createElement('textarea');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    textArea.value = text;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                textArea.style.position = 'fixed';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            textArea.style.left = '-999999px';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        textArea.style.top = '-999999px';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    document.body.appendChild(textArea);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                textArea.focus();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            textArea.select();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.execCommand('copy');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    textArea.remove();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    console.log('Text copied to clipboard successfully');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } catch (error) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                console.error('Failed to copy text to clipboard:', error);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        showTemporaryMessage('‚ö†Ô∏è Could not copy to clipboard. Please copy manually.', 'warning');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Show wish message
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            function showWishMessage(message) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                wishMessage.textContent = message;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    messageArea.classList.remove('hidden');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Auto-hide after 5 seconds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                setTimeout(() => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        hideMessage();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }, 5000);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Show temporary message
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            function showTemporaryMessage(message, type = 'info') {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Create temporary message element
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const tempMessage = document.createElement('div');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        tempMessage.className = `message-area temp-message ${type}`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tempMessage.innerHTML = `
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <div class="message-content">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p>${message}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            `;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Style based on type
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (type === 'warning') {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                tempMessage.style.background = 'rgba(237, 137, 54, 0.1)';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        tempMessage.style.borderColor = '#ed8936';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                tempMessage.style.color = '#c05621';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Insert before stars section
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const starsSection = document.querySelector('.stars-section');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    starsSection.parentNode.insertBefore(tempMessage, starsSection);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Remove after 3 seconds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                setTimeout(() => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (tempMessage.parentNode) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    tempMessage.parentNode.removeChild(tempMessage);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }, 3000);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Hide message area
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                function hideMessage() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    messageArea.classList.add('hidden');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Add some visual feedback for better UX
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    document.addEventListener('click', function(e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Add ripple effect to clickable elements
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (e.target.classList.contains('star') && !e.target.classList.contains('used')) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    createRippleEffect(e.target, e);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Create ripple effect
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        function createRippleEffect(element, event) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const circle = document.createElement('span');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const diameter = Math.max(element.clientWidth, element.clientHeight);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const radius = diameter / 2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const rect = element.getBoundingClientRect();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                circle.style.width = circle.style.height = `${diameter}px`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    circle.style.left = `${event.clientX - rect.left - radius}px`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        circle.style.top = `${event.clientY - rect.top - radius}px`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            circle.classList.add('ripple');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Add ripple styles
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        circle.style.position = 'absolute';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            circle.style.borderRadius = '50%';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                circle.style.background = 'rgba(255, 255, 255, 0.6)';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    circle.style.transform = 'scale(0)';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        circle.style.animation = 'ripple 0.6s linear';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            circle.style.pointerEvents = 'none';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    element.appendChild(circle);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            setTimeout(() => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (circle.parentNode) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                circle.parentNode.removeChild(circle);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }, 600);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Add ripple animation CSS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const style = document.createElement('style');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            style.textContent = `
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                @keyframes ripple {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        to {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    transform: scale(4);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                opacity: 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .star {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            position: relative;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    overflow: hidden;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        `;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.head.appendChild(style);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Keyboard shortcuts
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.addEventListener('keydown', function(e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Enter key to focus on first available star (when wish input is not focused)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (e.key === 'Enter' && document.activeElement !== wishInput) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const firstAvailableStar = document.querySelector('.star:not(.used)');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (firstAvailableStar && wishInput.value.trim()) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            firstAvailableStar.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Add accessibility improvements
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            stars.forEach((star, index) => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                star.setAttribute('role', 'button');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    star.setAttribute('tabindex', '0');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        star.setAttribute('aria-label', `Make wish number ${index + 1}`);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Keyboard support for stars
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    star.addEventListener('keydown', function(e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (e.key === 'Enter' || e.key === ' ') {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        e.preventDefault();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    star.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Initialize character counter on page load
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                updateCharacterCount();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                